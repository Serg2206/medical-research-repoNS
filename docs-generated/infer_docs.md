# Documentation: infer.py

**Файл:** `infer.py`

**Дата:** 2025-11-10

---

# Документация для кода

## Описание функционала

Этот код предназначен для инференса (получения предсказаний) с использованием предобученной модели классификации последовательностей из библиотеки `transformers`. Этот код может быть полезен для анализа текста с использованием моделей NLP (Natural Language Processing), таких как BERT, GPT-2, RoBERTa и т.д.

## Основные функции

### `infer_model(model_dir, text)`

Эта функция выполняет инференс с использованием заданной модели и возвращает вероятности для каждого класса.

#### Параметры

- `model_dir` (str): Путь к директории с предобученной моделью. Модель должна быть совместима с библиотекой `transformers`.
- `text` (str): Текст, который необходимо анализировать.

#### Возвращаемые значения

- `probabilities` (list): Список вероятностей для каждого класса. Вероятности представлены в виде списка списков, где каждый внутренний список содержит вероятности для каждого класса.

## Примеры использования

Для использования этого кода вам необходимо иметь предобученную модель и текст для анализа. Вы можете запустить код напрямую из командной строки, указав путь к модели и текст для анализа в качестве аргументов.

```bash
python script.py --model /path/to/model --text "Текст для анализа"
```

В этом примере `script.py` - это имя файла с кодом, `/path/to/model` - путь к директории с предобученной моделью, а `"Текст для анализа"` - текст, который вы хотите анализировать.

После выполнения кода вы увидите результаты предсказания в консоли:

```
Результаты предсказания: [[0.0123456789, 0.987654321]]
```

В этом примере модель предсказала, что вероятность принадлежности текста к первому классу составляет примерно 0.012, а к второму классу - примерно 0.988.