# Documentation: infer.py

**Файл:** `infer.py`

**Дата:** 2025-11-06

---

# Документация

## Описание функционала

Этот код представляет собой скрипт на языке Python, который использует модель классификации последовательностей из библиотеки `transformers` для анализа текста. Модель и текст для анализа передаются в качестве аргументов командной строки.

## Функции

### `infer_model(model_dir, text)`

#### Описание

Функция загружает предварительно обученную модель и токенизатор из указанного каталога, преобразует входной текст в токены, передает их в модель и возвращает вероятности, предсказанные моделью.

#### Параметры

- `model_dir` (`str`): Путь к каталогу, содержащему предварительно обученную модель и токенизатор.
- `text` (`str`): Входной текст, который нужно анализировать.

#### Возвращаемое значение

- `List[float]`: Список вероятностей, предсказанных моделью.

## Примеры использования

### Использование из командной строки

```bash
python script.py --model /path/to/model --text "Текст для анализа"
```

### Использование в коде

```python
model_dir = "/path/to/model"
text = "Текст для анализа"
probabilities = infer_model(model_dir, text)
print(probabilities)
```

## Примечания

- Этот код использует GPU для выполнения, если доступен, иначе использует CPU.
- Максимальная длина входного текста ограничена 128 токенами. Если текст длиннее, он будет обрезан.
- Вероятности, возвращаемые моделью, нормализуются с помощью функции softmax перед возвратом из функции `infer_model()`.