# Documentation: infer.py

**Файл:** `infer.py`

**Дата:** 2025-11-12

---

# Документация к коду

## Описание функционала

Этот код предназначен для инференса (применения) модели классификации текста, основанной на трансформерах. Он загружает предварительно обученную модель и токенизатор из указанной директории, преобразует входной текст в токены, а затем применяет модель к этим токенам. Результатом является вероятность принадлежности текста к каждому из классов, которые модель была обучена предсказывать.

## Функции

### infer_model(model_dir, text)

Функция для инференса модели классификации текста.

#### Параметры

- `model_dir` (str): Путь к директории, содержащей предварительно обученную модель и токенизатор.
- `text` (str): Текст, который нужно классифицировать.

#### Возвращаемые значения

- `probabilities` (list): Список вероятностей принадлежности текста к каждому из классов.

## Примеры использования

```bash
python script.py --model /path/to/model --text "This is a sample text"
```

В этом примере `/path/to/model` - это путь к директории, содержащей модель и токенизатор, а `"This is a sample text"` - это текст, который нужно классифицировать.

## Зависимости

- torch: Библиотека для работы с нейронными сетями.
- transformers: Библиотека от Hugging Face для работы с моделями трансформеров.
- argparse: Библиотека для обработки аргументов командной строки.

## Предположения

- Модель и токенизатор должны быть совместимыми и предварительно обученными.
- Текст должен быть на языке, на котором обучалась модель.
- Если доступна CUDA, код будет использовать ее для ускорения вычислений. В противном случае будет использоваться CPU.