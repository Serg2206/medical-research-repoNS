# Documentation: infer.py

**Файл:** `infer.py`

**Дата:** 2025-11-10

---

# Документация к коду

## Описание функционала

Данный код предназначен для инференса (получения предсказаний) с помощью обученной модели классификации текстов. Модель и текст для анализа передаются в качестве аргументов командной строки. Код использует библиотеку transformers для загрузки модели и токенизации текста, а также PyTorch для работы с моделью.

## Функции

### infer_model(model_dir: str, text: str) -> List[float]

Функция для инференса модели.

#### Параметры

- `model_dir` (str): Путь к директории, где сохранена предобученная модель. Модель должна быть совместима с библиотекой transformers.
- `text` (str): Текст, который нужно классифицировать.

#### Возвращаемое значение

- `List[float]`: Список вероятностей для каждого класса, возвращаемый моделью.

## Пример использования

Для использования скрипта необходимо передать путь к модели и текст для анализа в качестве аргументов командной строки. Например:

```bash
python script.py --model /path/to/model --text "Текст для анализа"
```

В результате скрипт выведет вероятности для каждого класса, возвращаемые моделью.

## Зависимости

- Python 3.6 или выше
- PyTorch 1.8.1 или выше
- transformers 4.6.1 или выше

## Примечания

- Модель и токенизатор должны быть совместимы с библиотекой transformers.
- Если доступна CUDA, модель будет использовать GPU для инференса. В противном случае будет использоваться CPU.
- Текст обрезается и дополняется до длины 128 токенов. Если исходный текст длиннее, он будет обрезан. Если короче - дополнен.