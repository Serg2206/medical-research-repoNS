# Documentation: train.py

**Файл:** `train.py`

**Дата:** 2025-11-06

---

# Документация для кода

## Описание функционала

Этот код представляет собой начало процесса обучения модели машинного обучения для классификации текста, используя библиотеку transformers и модель BERT. Он включает в себя подготовку данных, создание датасета и некоторые начальные настройки.

## Параметры и возвращаемые значения

### Класс MedicalDataset

Этот класс представляет собой подкласс PyTorch Dataset, который используется для загрузки данных.

- `__init__(self, data, tokenizer, max_length=128)`: инициализирует экземпляр класса. Принимает на вход данные, токенизатор и максимальную длину последовательности.
- `__len__(self)`: возвращает длину датасета.
- `__getitem__(self, idx)`: возвращает элемент датасета по индексу. Токенизирует текст и возвращает тензоры входных данных и маски внимания, а также метку.

### Функция prepare_data

Эта функция предназначена для подготовки данных, разделения их на обучающую и тестовую выборки.

- `input_csv`: Путь к входному CSV-файлу.
- `output_dir`: Директория для сохранения обработанных данных.
- `test_size`: Размер тестовой выборки (доля от общего объема данных).

## Примеры использования

```python
# Создание экземпляра токенизатора
tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)

# Подготовка данных
prepare_data('data.csv', 'output_dir')

# Создание экземпляра датасета
data = pd.read_csv('output_dir/train.csv')
dataset = MedicalDataset(data, tokenizer)
```

Примечание: в этом коде предполагается, что у вас есть файл 'data.csv' с вашими данными и директория 'output_dir', куда вы хотите сохранить обработанные данные.