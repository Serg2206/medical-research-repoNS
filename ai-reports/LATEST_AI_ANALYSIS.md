# ü§ñ AI Code Analysis Report

**–î–∞—Ç–∞:** 2025-11-14 03:45:03

**–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 5

## üìÅ train.py

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 124

### üéØ AI –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

–í —Ü–µ–ª–æ–º, –∫–æ–¥ —Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω, –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ–º –∏ —Å–ª–µ–¥—É–µ—Ç best practices. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π**: –í —Ñ—É–Ω–∫—Ü–∏–∏ `prepare_data` –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ 'text' –∏ 'label' –≤ –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–µ—Ç, —Ç–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ. –≠—Ç–æ —Ö–æ—Ä–æ—à–æ, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –¥–∞–Ω–Ω—ã—Ö.

2. **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –í —Ñ—É–Ω–∫—Ü–∏–∏ `prepare_data` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `str.strip()`. –≠—Ç–æ —É–¥–∞–ª—è–µ—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏. –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º —Å—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ –ø–æ –æ—á–∏—Å—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã –æ–∂–∏–¥–∞–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –≤ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

3. **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã**: –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã `MODEL_NAME`, `DEVICE` –∏ –¥—Ä—É–≥–∏–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏. –õ—É—á—à–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏—Ö –≤ —Ñ—É–Ω–∫—Ü–∏—é `main` –∏–ª–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏, –≥–¥–µ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω.

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ —Å—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (docstrings) –≤ –≤–∞—à –∫–æ–¥. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –¥—Ä—É–≥–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –±—ã—Å—Ç—Ä–µ–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–∞—à –∫–æ–¥.

5. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU**: –í–∞—à –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω. –≠—Ç–æ –æ–±—ã—á–Ω–æ —Ö–æ—Ä–æ—à–∞—è –∏–¥–µ—è, –Ω–æ –∏–Ω–æ–≥–¥–∞ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ—Ç–µ—Ç—å –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ GPU –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–±—Ä–∞—Ç—å, –∫–∞–∫–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å).

6. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**: –í —Ñ—É–Ω–∫—Ü–∏–∏ `train_model` –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ AdamW –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è (learning rate scheduling). –í–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.

7. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**: –í –∫–æ–Ω—Ü–µ –æ–±—É—á–µ–Ω–∏—è –≤—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç–µ –º–æ–¥–µ–ª—å –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é. –≠—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –µ—Å–ª–∏ –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏.

---

## üìÅ main.py

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 111

### üéØ AI –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

–í —Ü–µ–ª–æ–º, –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω —Ö–æ—Ä–æ—à–æ –∏ —Å–ª–µ–¥—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º Python –∏ PyTorch. –û–¥–Ω–∞–∫–æ, –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. **–ò–º–ø–æ—Ä—Ç—ã**: –ò–º–ø–æ—Ä—Ç `os` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–µ, –µ–≥–æ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å. 

2. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –í–∞—à –∫–æ–¥ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–ª–∏ docstrings, –∫–æ—Ç–æ—Ä—ã–µ –±—ã –æ–±—ä—è—Å–Ω—è–ª–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏ –∫–ª–∞—Å—Å. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞ –¥—Ä—É–≥–∏–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏.

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –í–∞—à –∫–æ–¥ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –æ—à–∏–±–∫–∞–º –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞, —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å.

4. **–ñ–µ—Å—Ç–∫–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–∞–∑–º–µ—Ä—ã –≤—Ö–æ–¥–Ω–æ–≥–æ, —Å–∫—Ä—ã—Ç–æ–≥–æ –∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –∏ —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö `train_model` –∏ `predict`. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–∞—à –∫–æ–¥ –º–µ–Ω–µ–µ –≥–∏–±–∫–∏–º. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π.

5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –í–∞—à –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç PyTorch. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DataLoader` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `num_workers > 0` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

6. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–∞—à –∫–æ–¥ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã –ø—Ä–æ–≤–µ—Ä—è–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–ª–∞—Å—Å–æ–≤. 

7. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ `print` –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ `logging` –≤ Python –∏–ª–∏ `tensorboard` –≤ PyTorch.

8. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏**: –í–∞—à –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –µ—Å–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—Å—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—é –º–æ–¥–µ–ª—å, –∏—Å–ø–æ–ª—å–∑—É—è `torch.save(model, filepath)` –∏ `model = torch.load(filepath)`.

---

## üìÅ infer.py

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 35

### üéØ AI –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

–í —Ü–µ–ª–æ–º, –∫–æ–¥ —Ö–æ—Ä–æ—à–æ –Ω–∞–ø–∏—Å–∞–Ω –∏ —Å–ª–µ–¥—É–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É best practices. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ú–æ–¥–µ–ª—å –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ `infer_model`. –ï—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –æ–¥–∏–Ω —Ä–∞–∑ –∏ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö –≤ —Ñ—É–Ω–∫—Ü–∏—é. –≠—Ç–æ —É–º–µ–Ω—å—à–∏—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏.

2. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `**tokens` –≤ –≤—ã–∑–æ–≤–µ –º–æ–¥–µ–ª–∏, –ª—É—á—à–µ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤—ã –ø–µ—Ä–µ–¥–∞–µ—Ç–µ –≤ –º–æ–¥–µ–ª—å. –≠—Ç–æ —É–ª—É—á—à–∏—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ –∏ —Å–¥–µ–ª–∞–µ—Ç –µ–≥–æ –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–º –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

3. **Best Practices**: –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `print` –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ª–æ–≥–≥–µ—Ä Python. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –±–æ–ª–µ–µ –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–≤–æ–¥–æ–º –∏, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è, –ª–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –≤—ã–≤–æ–¥ –≤ —Ñ–∞–π–ª –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫.

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í —ç—Ç–æ–º –∫–æ–¥–µ –Ω–µ—Ç —è–≤–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é. –û–¥–Ω–∞–∫–æ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤–∞–∂–Ω–æ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∞—Ç–∞–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –∏–ª–∏ XSS-–∞—Ç–∞–∫), –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —ç—Ç–æ—Ç –∫–æ–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

–í–æ—Ç –∫–∞–∫ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —É–ª—É—á—à–µ–Ω–Ω—ã–π –∫–æ–¥:

```python
import argparse
import logging
import torch
from transformers import AutoModelForSequenceClassification, AutoTokenizer

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
DEVICE = torch.device("cuda" if torch.cuda.is_available() else "cpu")

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–≥–µ—Ä–∞
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

def load_model_and_tokenizer(model_dir):
    tokenizer = AutoTokenizer.from_pretrained(model_dir)
    model = AutoModelForSequenceClassification.from_pretrained(model_dir)
    model.to(DEVICE)
    return model, tokenizer

def infer_model(model, tokenizer, text):
    tokens = tokenizer(
        text, return_tensors="pt", truncation=True, padding=True, max_length=128
    )
    tokens = {k: v.to(DEVICE) for k, v in tokens.items()}

    model.eval()
    with torch.no_grad():
        outputs = model(input_ids=tokens['input_ids'], attention_mask=tokens['attention_mask'])
        probabilities = torch.softmax(outputs.logits, dim=-1)

    return probabilities.tolist()

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="–ò–Ω—Ñ–µ—Ä–µ–Ω—Å —Å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é")
    parser.add_argument("--model", required=True, help="–ü—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏")
    parser.add_argument("--text", required=True, help="–¢–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")
    args = parser.parse_args()

    model, tokenizer = load_model_and_tokenizer(args.model)
    result = infer_model(model, tokenizer, args.text)
    logger.info(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {result}")
```

---

## üìÅ prepare_data.py

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 53

### üéØ AI –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

–í —Ü–µ–ª–æ–º, –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω —Ö–æ—Ä–æ—à–æ –∏ —Å–ª–µ–¥—É–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É best practices. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π**: –í –∫–æ–¥–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ CSV-—Ñ–∞–π–ª–∞. –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π. –õ—É—á—à–µ –¥–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ try/except, —á—Ç–æ–±—ã –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–∏ —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ –≤—ã–≤–µ—Å—Ç–∏ –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ `logger = logging.getLogger(__name__)`, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ —É–ª—É—á—à–∏—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ –∏ —Å–¥–µ–ª–∞–µ—Ç –µ–≥–æ –±–æ–ª–µ–µ –º–æ–¥—É–ª—å–Ω—ã–º.

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ `prepare_data` —Ö–æ—Ä–æ—à–∞, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –æ —Ç–æ–º, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è, –∫–∞–∫–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ —á—Ç–æ –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç.

4. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞**: –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `os.path.join(output_dir, "train.csv")` –∏ `os.path.join(output_dir, "test.csv")` –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `train_file_path` –∏ `test_file_path` –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∫–æ–¥–∞.

5. **–ü–∞—Ä–∞–º–µ—Ç—Ä `test_size`**: –ü–∞—Ä–∞–º–µ—Ç—Ä `test_size` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `prepare_data` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–µ–Ω 0.2. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º, –¥–æ–±–∞–≤–∏–≤ –µ–≥–æ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

6. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `data["text"].str.strip()` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `data["text"] = data["text"].apply(lambda x: x.strip())`. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö.

7. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í –∫–æ–¥–µ –Ω–µ—Ç —è–≤–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é. –û–¥–Ω–∞–∫–æ, –≤—Å–µ–≥–¥–∞ —Å—Ç–æ–∏—Ç –±—ã—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –∏–ª–∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## üìÅ scripts/fix_csv_headers.py

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 29

### üéØ AI –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

–í —Ü–µ–ª–æ–º, –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω —Ö–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–Ω–∞—á–∞–ª–∞ —Å—á–∏—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç—å, –∞ –∑–∞—Ç–µ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏—Ö, –º–æ–∂–Ω–æ —Å—á–∏—Ç—ã–≤–∞—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –ø–æ –æ–¥–Ω–æ–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–Ω–∏–∑–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏.

2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –∫–æ–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø–æ—Å–ª–µ —á—Ç–µ–Ω–∏—è, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ–≥–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.

3. –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å: –¶–∏–∫–ª for –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–π –∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π list comprehension.

4. Best practices: –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å logging –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –∞ –Ω–µ print. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–≤–æ–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π, –≤–∫–ª—é—á–∞—è —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞:

```python
#!/usr/bin/env python3
"""Fix CSV file by removing invalid header rows"""

import csv
import sys
import logging
import tempfile
import shutil

logging.basicConfig(level=logging.INFO)

# Temporary file for cleaned CSV
temp_file = tempfile.NamedTemporaryFile(delete=False)

with open("training-data/medical_training_data.csv", "r", encoding="utf-8") as f_in, open(temp_file.name, "w", encoding="utf-8") as f_out:
    valid_lines = 0
    invalid_lines = 0
    for i, line in enumerate(f_in):
        if i == 0 or "," in line:  # Keep the header row and lines with CSV data
            f_out.write(line)
            valid_lines += 1
        else:
            logging.info(f"Removing invalid line {i+1}: {line.strip()}")
            invalid_lines += 1

# Replace the original file with the cleaned one
shutil.move(temp_file.name, "training-data/medical_training_data.csv")

logging.info(f"\nDone! Kept {valid_lines} valid lines, removed {invalid_lines} invalid lines")
```

–≠—Ç–æ—Ç –∫–æ–¥ –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π, –Ω–æ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

---

